<!DOCTYPE html>
<html lang="zh-Hant">
  <head>
    <meta charset="utf-8" />
    <title>臺北交通事故資料視覺化地圖</title>
    <meta
      name="viewport"
      content="initial-scale=1,maximum-scale=1,user-scalable=no"
    />
    <link
      href="https://api.mapbox.com/mapbox-gl-js/v2.14.1/mapbox-gl.css"
      rel="stylesheet"
    />
    <script src="https://api.mapbox.com/mapbox-gl-js/v2.14.1/mapbox-gl.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/proj4@2.9.2/dist/proj4.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@turf/turf@6/turf.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="stylesheet" href="style.css" />
    <script defer src="main.js"></script>
  </head>
  <body>
    <div id="map"></div>

    <!-- 右側滑出統計面板 -->
    <div id="sidePanel">
      <div class="sp-header">
        <div class="sp-header-top">
          <div class="sp-title" id="spTitle">選擇一個行政區</div>
          <button class="sp-close" id="spClose" title="關閉">×</button>
        </div>
        <select id="monthSelect">
          <option value="all">全部月份</option>
          <option value="1">1 月</option>
          <option value="2">2 月</option>
          <option value="3">3 月</option>
          <option value="4">4 月</option>
          <option value="5">5 月</option>
          <option value="6">6 月</option>
          <option value="7">7 月</option>
          <option value="8">8 月</option>
          <option value="9">9 月</option>
          <option value="10">10 月</option>
          <option value="11">11 月</option>
          <option value="12">12 月</option>
        </select>
      </div>
      <div class="sp-body">
        <div class="sp-stat">
          <div class="sp-card">
            <div class="kpi" id="kpiTotal">0</div>
            <div class="lbl">事故總數</div>
          </div>
          <div class="sp-card">
            <div class="kpi" id="kpiA1">0</div>
            <div class="lbl">A1 嚴重</div>
          </div>
          <div class="sp-card">
            <div class="kpi" id="kpiA2">0</div>
            <div class="lbl">A2 一般</div>
          </div>
        </div>

        <div class="chartTitle">單月事故種類</div>
        <div class="chartBox">
          <canvas id="chartBar" width="280" height="180"></canvas>
        </div>

        <div class="chartTitle" style="margin-top: 10px">
          全年事故趨勢（總數）
        </div>
        <div class="chartBox">
          <canvas id="chartLine" width="280" height="160"></canvas>
        </div>

        <div class="chartTitle" style="margin-top: 10px">
          單月當事者/車種分類
        </div>
        <div class="chartBox">
          <canvas id="chartPie" width="280" height="220"></canvas>
        </div>
      </div>
    </div>

    <div class="legend">
      <b>事故熱度</b>
      <div class="bar"></div>
      <div>低 ← 熱度 → 高</div>
    </div>
  </body>
</html>
